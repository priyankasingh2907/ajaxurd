#1.SUBMIT FORM - CREATE STUDENT

<!-- 1.student Model -->
<!-- 2.student Controller   -->
<!-- 3.Route  -->
Route::get('/add-student',function(){
return view('student-form');
});
Route::post('/submit-student',[studentController::class,'store'])->name('submit-student');
<!-- jquery cmd  -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<!-- 4. from frontend  -->
<form action="" id="my-form">
    @csrf
    <input type="text" name="name" placeholder="name" required>
    <br><br>
    <input type="email" name="email" placeholder="email" required>
    <br><br>
    <input type="file" name="image" required>
    <br><br>
    <input type="submit" value="Add Student" id="btnSubmit">
</form>
<span id="output"></span>

<Script>


    $(document).ready(function () {
        $("#my-form").submit(function (e) {
            e.preventDefault();
            var form = $("#my-form")[0];   //form object
            var data = new FormData(form);    //form data
            $("#btnSubmit").prop("disabled", true);
            $.ajax({
                type: "POST",
                url: "{{route('submit-student')}",
                data: data,
                processData: false,
                contentType: false,
                success: function (data) {
                    // alert(data.res); //getdata
                    $("#output").text(data.res);
                    $("#btnSubmit").prop("disabled", false);
                    

                    // empty after submition
                    $("input[type='text']").val('');
                    $("input[type='email']").val(''); 
                    $("input[type='file']").val('');  

                },
                error: function (e) {
                    $("#output").text(e.res);
                    // console.log(e.responseText);
                    $("#btnSubmit").prop("disabled", false);

                    $("input[type='text']").val('');
                    $("input[type='email']").val(''); 
                    $("input[type='file']").val('');
                }
            });


        })
    })
</Script>

<!-- Student Controller  -->
public function addstudent(Request $request){    
 <!-- return response()->json([
 'res'=>"getdata",
 'sataus'=>true
 ], 200 ); -->
}

 public function submit-student( Request $request){
    <!-- return response()->json([ 'res'=>'show data', ]); -->

    $file = $request->image('file');
    $fileName = time().''.$file->getClientOriginalName();
    $filePath = $file->storeAs('images'.fileName,'public');
    
    $student = new Student ;
    $student->name = $request->name;
    $student->email = $request->email;
    $student->image = $filePath;
    $student->save();

    return response()->json([
    'res'=>"sudent created successfully",
    'sataus'=>true
    ], 200 );

 }

 <!-- optimize -->
  php artisan optimize

  ----------------------------------
  #2.READ OPERATION USING ajax

Route::get('/getstudent',function(){
    return view('studeny-data');
});

Route::post('/get-student',[studentController::class,'get-student'])->name('get-student');

<!-- controller -->
 public function get-student(){
    $students = student::all();

    return response()->json([
    'res'=>$students,
    'sataus'=>true
    ], 200 );
 }

<h1>student data</h1>
<table class="table" id="students-table">
    <thead>
        <tr>
            <th>S.no</th>
            <th>Name</th>
            <th>Email</th>
            <th>file</th>
            <th>Action</th>

        </tr>
    </thead>
    <tbody>
        
       
    </tbody>
    <a href="" class="deleteDataouter">delete</a>
</table>

<script>

</script>
<script>
    $(document).ready(function(){
         $.ajax({
            type:"GET",
            url:"{{route('get-student')}}",
            success:function(data){
                // console.log(data);

                if(data.students.length>0){
                    for(let i=0; i<data.students.length;i++){

                        let images = data.students[i]['images'];
                        $("#students-table").append(`<tr>

                            <td>`+(i+1)+`</td>
                            <td>   `+ (data.students[i]['name'])+`    </td>                                  <td>   `+ (data.students[i]['name'])+`    </td>
                            <td>   `+ (data.students[i]['email'])+`    </td>
                            <td>
                                <img src={{url('public/images/`+images+`')}} alt="`+img+`" width="100px" height="100px">
                                
                                </td>
                                <td><a href="editUser/`+(data.students[i][id])+`">Edit</a>
                                    <a href="#" class="deleteDataInner" data-id="`+(data.students[i][id])+`">delete</a></td>
   
                            </tr>`)
              
                    }

                }else{
                    $("#students-table").append("<tr><td colspan='4'>Data Not Found.</td></tr>")
                }
            },
            error:function(err){
                console.log(err.responseText);
            }
         });
        //  students-table
        $("#students-table").on("click","deleteDataInner",function(){
    var id = $(this).attr("data-id");  //data will show alter after click
   var obj = $(this);
   
    $.ajax({
    type:"GET",
    url:"delete/"+id,
    success:function(data){
console.log(data);
$(obj).parent().parent().remove();
    },
    error:function(err){
        console.log(err);

    }
   });

}) 

$(".deleteDataouter").click(function(){
    alert($(this).attr("data-id"));  //data will show alter after click
})  

    });
</script>

<!-- link storage -->
 php artisan storage:link


-----------------------------------
3.UPDATE USER
Route::get('/editUser',[studentControler::class,'editUser'])->name('edit-student');
Route::post('/updateUser',[studentControler::class,'updateUser'])->name('update-student');

public function getstudentaData($id){
    $student = student::where('id'.$id)->get();


    return view('student-edit'.['student'=>$student]);

}

public function updateUser(Request $request){
    $student= student::find($request->id);

    if($request->file('image')){
        $file = $request->image('file');
        $fileName = time().''.$file->getClientOriginalName();
        $filePath = $file->storeAs('images'.fileName,'public');
        
    }else{
 

    }
    $student->name = $request->name;
    $student->email = $request->email;
    $student->image = $filePath;
    $student->save();

    return response()->json([
    'res'=>"sudent updated successfully",
    'sataus'=>true
    ], 200 );


}

<img src="{{url('storage/')}}/{{$student[0]->image}}" alt="" width="100px">
<form action="" id="update-form">
    @csrf
    <input type="text" name="name" value="{{$student[0]->name}}" placeholder="name" required>
    <br><br>
    <input type="email" name="email" value="{{$student[0]->name}}" placeholder="email" required>
    <br><br>
    <input type="file" name="image" required>
    <input type="hidden" name="id" value="{{$student[0]->id}}">
    <br><br>
    <input type="submit" value="update Student" id="btnSubmit">
    <span id="output"></span>
</form>
<script>
    $(document).ready(function(){
        $("#update-form").submit(function(e){
            e.preventDefault();
            var form = $("#update-form")[0];
            var data = new FormData(form);

            $.ajax({
                type:"POST",
                url:"{{route('')}}",
                data:data,
                processData:false,
                contentType:false,
                success:function(data){
                $("output").text(data.res);
                window.open("/getUser","_self")

                },
                error:function(err){
                    $("output").text(data.res);
                }
            });
        });
    });
</script>
---------------------------------------
4.DELETE USER
Route::get('/delete/{id}',[studentControler::class,'delete'])->name('delete-student');

public function($id){
    $student = student::where('id',$id)->delete();
    return response()->json([
    status=>true,
    data=>deleted successfully ,
    ] , 200);

}


----------------------------------------------------------
AUTO-COMPLETE 
php artisan make:model product --all()

Route::get('/search',[productsController::class,'product-search'])->name('productSearch');

public function product(Request $request){

if($request->ajax()){
    $product = product::where('name','LIKE',$request->product.'%')->get();
    $output='';

    if(count($product)>0)
$output = '<ul class="list-group" style="display:relative;z-index: 999;">
foreach($product as $row){
    $oupput.='<li class="list-group-item">`.$row->name.`</li>';
}
$output.='</ul>';
}else{
    output.='<li class="list-group-item">No Data Found</li>';
}

    return view('products');

}

<!DOCTYPE html>
<html lang="en">
<head>
  <tite>Searching</tite>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>
<body>

<div class="container">
<div class="row align-items-center">
    <div class="col-10">
        <label for="product" class="form-label">Search Product</label>
<input type="text" name="product" class="form-control" id="product"placeholder="search product">
    </div>

</div>
<div id="product_list"></div>
</div>
<script>
    $(document).ready(function(){
        $("product").on("keyup",function(){
            var val = $(this).val();
            $.ajax({
                url:"{{route('productSearch')}}",
                type:"GET",
                data:{'product':val},
                success:function(data){
$("#product_list").html(data);
                },
                error:function(err){
$("#product_list").html(err);

                }

            })
        })
        $(document).on('click','li',function(){
            var val = $(this).text();
            $("#name").val(val);
            $("#product_list").html("");
        })
    });
</script>
</body>
</html>

----------------------------------------------------------
multiple Searching

public function Search (Request $request){

    $search = product::all();
    return view('search',compact('search');)
}

<!-- get  -->

<script>
    $(document).ready(function(){
        var val = $(this).val();
        $.ajax({
            url:"{{route()}}",
            type:"GET",
            data:('search':val),
            success:function(users){
                var user = user.user;
                var html= '';
                if(user.length>0){
                    for(let i = 0; i<user.length;i++){
                        html+=`<tr>\
                            <td>`+(user[i]['id'])+`</td>
                              <td>`+(user[i]['name'])+`</td>
                                <td>`+(user[i]['email'])+`</td>
                                  <td>`+(user[i]['phn'])+`</td>
                            </tr>`;
                    }

                }else{
                  html=`<tr>\
                    <td colspan=4>no data</td>
                    `;


                }
                $("#tbody").html(html);
                 
            }

        })
    });
</script>

public function search (Request $request){
$query = user::query();
if($request->ajax()){
    $search = $query->where('name','LIKE','%'.$request->search.'%')
    ->orWhere('email','LIKE','%'.$request->search.'%')
        ->orWhere('phn','LIKE','%'.$request->search.'%')
->get();
return response()->json(['user'=>$user]);

}else{
    $search = $query->get();
    return view('search',compact('search'))
}
}
----------------------------------------------------------
<!-- filter -->

<!-- product , category model -->
 <!-- product controller  -->

 Route::get('/filter',[productsController::class,'product-filter'])->name('productFilter');
public function filter(Request $request){
     $query = Product::query();
     $category = Category::all();

     if($request->ajax()){
        if(empty($request->category))
        {
            $product = $$query->get();
        }else{
            $product = $query->where(['category_id'=>$request->category])->get();
        }
        $product =  $query->where(['category_id'=>$request->category])->get();
return response()->json([
'product'=>$product;
]);
     }

$product = $query->get();
   return view('product',['product'=>$product,'category'=>$category]); 

}

<select name="category" id="category">
    <option value="">Select Category</option>
@if(!empty($category))
@foreach($category as $cat)
<option value="{{$cat->id}}">{{$cat->name}}</option>
@endforeach
@endif
</select>
<table>
    <tr>
        <th>S no.</th>
        <th>name</th>
        <th>Price.</th>
        <th>Description</th>
    </tr>
    <tr>
        @if(!empty($product))
        @foreach($product as $pro)
        <td>{{$pro->id}}</td>
        <td>{{$pro->name}}</td>
        <td>{{$pro->price}}</td>
        <td>{{$pro->description}}</td>
        @endforeach
        @endif
    </tr>
</table>

<script>
    $(document).ready(function(){
        $("#category").on('change',function(){
            var category= $(this).val();
            $.ajax({
                url:"{{route('filter')}}",
                data:{'category':category},
                success:function(data){
console.log(data);
var user = user.user;
                var html= '';
                if(user.length>0){
                    for(let i = 0; i<user.length;i++){
                        html+=`<tr>\
                            <td>`+(user[i]['id'])+`</td>
                              <td>`+(user[i]['name'])+`</td>
                                <td>`+(user[i]['email'])+`</td>
                                  <td>`+(user[i]['phn'])+`</td>
                            </tr>`;
                    }

                }
            else{
                  html+=`<tr>\
                    <td colspan=4 >no data</td>
                    </tr>`;


                }

                $("#tbody").html(html);
        })
    })
</script>